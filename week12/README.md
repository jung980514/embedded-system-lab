# 임베디드 시스템 설계 및 실험 12주차 결과 보고서
7조 이석우, 손수민, 정지용, 김춘수


## 1. 실험 목표
1. DMA 이해 및 실습

## 2. 배경 지식

### Direct Memory Access (DMA)

&nbsp;&nbsp;DMA란 주변장치들이 메모리에 직접 접근하여 읽거나 쓸 수 있도록 하는 기능을 지원한다. CPU 의 개입 없이 I/O 장치와 기억장치 데이터를 전송할 수 있게 되어, CPU는 Interrupt와 달리 별도의 명령을 실행할 필요가 없다. 메모리 처리 Interrupt의 사이클만큼 성능이 향상된다.


![캡처_2021_11_18_20_24_09_63](https://user-images.githubusercontent.com/62247273/142562129-9a934f4c-8b0c-4610-8b1e-6688139ffe69.png)
![캡처_2021_11_18_20_24_16_611](https://user-images.githubusercontent.com/62247273/142562130-809a6792-6013-450f-be57-e18cbd7600c4.png)

&nbsp;&nbsp;왼쪽 그림은 DMA가 작동하지 않을 떄의 흐름을 나타낸 모식도이다. 모든 I/O로의 접근은 CPU를 통해서 수행된다 Data를 전달할 때마다 CPU가 관여한다. 반면, 오른쪽 그림은 DMA 방식을 나타낸 것이다. RAM이 I/O 장치로부터 데이터가 필요하면, CPU는 DMA 컨트롤러에게 신호(전송 크기, 주소 등)을 보낸다. DMA 컨트롤러가 RAM 주소로 데이터를 bus를 통해 주고 받으며, 모든 데이터 전송이 종료되면, DMA 컨트롤러가 CPU에 인터럽트 신호를 보낸다.

### DMA Channel
&nbsp;&nbsp;모듈은 DMA 컨트롤러의 DMA 채널을 통해 메모리 Read/Write를 할 수 있다. STM32 보드의 DMA 채널은 총12개(DMA1 채널 7개, DMA2 채널 5개)이다. 한 DMA의 여러 채널 사이 요청은 우선순위에 따르는데 4가지 단계로 구성이 되어 있다(very high, high, medium, low). 주변 기기-메모리, 메모리-주변기기, 주변기기-주변기기 간의 전송이 가능하다.

### DMA Mode
&nbsp;&nbsp;DMA Mode는 두 가지가 있는데 첫 번째로 Normal Mode가 있다. DMA 컨트롤러는 데이터를 전송할 때마다 NDT값을 감소시킨다. NDT는 DMA를 통해 전송할 데이터의 총 용량을 의미하며 레지스터의 값이 0이 되면 데이터 전송 중단한다. 데이터 전송을 받고 싶을 때 마다 새롭게 요청이 필요하다.
</br>&nbsp;&nbsp;두 번째는 Circular Mode로서 주기적인 값의 전송(업데이트)이 필요할 때 사용하는 모드이다. NDT값이 0이 될 경우 설정한 데이터 최대 크기로 재설정된다.


